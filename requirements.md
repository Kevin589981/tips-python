# 临时笔记CLI工具需求文档

## 项目概述
开发一个Python CLI工具 `tips`，用于快速创建临时笔记。笔记文件在编辑器关闭后自动删除。

## 核心功能

1.  **快速创建笔记**:
    *   在用户主目录下的 `.tips` 文件夹中创建一个临时文件。
    *   文件名格式: `YYYYMMDD_HHMMSS_microseconds.md` (例如: `20231027_143015_123456.md`)
    *   文件后缀名可配置，默认为 `.md`。

2.  **编辑器支持与调用**:
    *   支持多种常见编辑器 (VS Code, Notepad++, Notepad, Sublime Text, Vim, Nano等)。
    *   默认编辑器为 VS Code (`code`)。
    *   提供命令行选项覆盖默认编辑器。
    *   配置文件可定义不同编辑器的启动命令和参数。

3.  **进程追踪与文件清理**:
    *   工具启动编辑器打开临时文件。
    *   工具需可靠地追踪编辑器进程或文件状态。
    *   当编辑器关闭或检测到文件不再被编辑器独占锁定时，自动删除该临时文件。
    *   *实现策略*: 优先考虑追踪编辑器进程（如果API稳定且可靠）。如果进程追踪不可靠或复杂，则采用文件锁定检测（例如，定期尝试获取文件的独占写锁，成功则认为编辑器已关闭）。

4.  **配置**:
    *   配置文件位置: 用户主目录下的 `.tips_config` (或类似隐藏文件/文件夹)。
    *   配置内容:
        *   默认编辑器名称 (e.g., `default_editor: "vscode"`)
        *   默认文件后缀名 (e.g., `default_extension: ".md"`)
        *   各编辑器的启动命令和参数 (e.g.,
          ```yaml
          editors:
            vscode:
              command: "code"
              args: ["--wait"] # VS Code --wait 参数使其阻塞直到窗口关闭
            notepad:
              command: "notepad"
              args: []
            notepadpp:
              command: "notepad++"
              args: ["-multiInst"] # Notepad++ 多实例参数示例
          ```
          )
    *   提供命令行选项来指定配置文件路径（高级用法）。

5.  **安装与使用**:
    *   工具需打包发布到 PyPI。
    *   用户可通过 `pip install tips-cli-tool` (或类似名称) 安装。
    *   安装后，用户只需在命令行输入 `tips` 即可运行。
    *   **Windows 特殊需求**: 支持通过 `Win + R` -> 输入 `tips` 直接运行，且不弹出命令行窗口。
        *   *实现方案*: 发布时除了Python包，可能需要提供一个 `.exe` 启动器（使用如 `PyInstaller` 打包，并设置 `--windowed` 或 `--noconsole` 选项），或者确保Python Launcher for Windows配置正确且无控制台窗口弹出。此需求可能需要额外的打包步骤或文档说明。

## 非功能性需求

1.  **跨平台**: 代码应尽量兼容 Windows, macOS, Linux。
2.  **健壮性**: 处理编辑器未找到、启动失败、文件删除失败等异常情况。
3.  **简洁性**: 命令行界面简单，无过多输出。
4.  **性能**: 启动和清理速度快。

## 待明确/讨论点

1.  **进程追踪 vs 文件锁定检测**: 哪种方式在跨平台场景下更稳定、可靠？进程追踪可能在某些编辑器或系统上不可行。
2.  **Windows `Win + R` 无窗口运行**: 实现此功能的最佳实践是什么？是通过特定的打包方式还是其他机制？
3.  **配置文件格式**: 使用 YAML, JSON, INI 还是其他？YAML 对于带有结构的配置可能更友好。
4.  **编辑器列表**: 初始版本需要支持哪些编辑器？后续如何扩展？
5.  **PyPI 包名**: `tips-cli-tool`, `quick-tips`, `tmpnote` 或其他？
